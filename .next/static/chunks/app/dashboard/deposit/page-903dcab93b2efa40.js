(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[272],{3226:(e,t,a)=>{Promise.resolve().then(a.bind(a,6053))},6053:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i});var r=a(5155),s=a(2115),l=a(2619),n=a.n(l);function i(){let[e,t]=(0,s.useState)(""),[a,l]=(0,s.useState)(""),[i,d]=(0,s.useState)(!1),[o,p]=(0,s.useState)(null);async function u(t){t.preventDefault();let r=parseFloat(e);if(r<10||r>15e4)return void p({type:"err",text:"Amount must be between KES 10 and 150,000"});d(!0),p(null);try{var s;let e=await fetch("/api/deposit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:r,phone:a.trim()})}),t=await e.json();if(!e.ok)return void p({type:"err",text:t.error||"Request failed"});p({type:"ok",text:null!=(s=t.message)?s:"STK push sent. Complete payment on your phone."})}catch(e){p({type:"err",text:"Request failed"})}finally{d(!1)}}return(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-white mb-4",children:"Deposit via M-Pesa"}),(0,r.jsxs)("div",{className:"card-apex max-w-md",children:[(0,r.jsxs)("form",{onSubmit:u,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm text-gray-300 mb-1",children:"Phone (254...) "}),(0,r.jsx)("input",{type:"tel",value:a,onChange:e=>l(e.target.value),placeholder:"254712345678",required:!0,className:"w-full bg-apex-muted border border-apex-primary/30 rounded-lg px-3 py-2 text-white"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm text-gray-300 mb-1",children:"Amount (KES)"}),(0,r.jsx)("input",{type:"number",min:10,max:15e4,step:10,value:e,onChange:e=>t(e.target.value),required:!0,className:"w-full bg-apex-muted border border-apex-primary/30 rounded-lg px-3 py-2 text-white"})]}),o&&(0,r.jsx)("p",{className:"err"===o.type?"text-red-400":"text-apex-primary",children:o.text}),(0,r.jsx)("button",{type:"submit",disabled:i,className:"w-full btn-primary py-3 rounded-xl disabled:opacity-50",children:i?"Sending...":"Pay with M-Pesa"})]}),(0,r.jsx)("p",{className:"mt-4 text-gray-500 text-sm",children:(0,r.jsx)(n(),{href:"/dashboard",className:"text-apex-primary hover:underline",children:"Back to dashboard"})})]})]})}}},e=>{e.O(0,[619,441,255,358],()=>e(e.s=3226)),_N_E=e.O()}]);